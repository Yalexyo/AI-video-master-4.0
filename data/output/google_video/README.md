# Google Cloud Video Intelligence 视频片段

这个目录包含通过 Google Cloud Video Intelligence API 分析后切分的视频片段。

## 📁 文件命名规则

视频片段文件按以下格式命名：
```
{video_id}_google_seg_{序号}_{类型}_{开始时间}s-{结束时间}s.mp4
```

例如：
- `myvideo_google_seg_001_镜头1_0.0s-3.5s.mp4`
- `myvideo_google_seg_002_标签_猫_5.2s-8.7s.mp4`
- `myvideo_google_seg_003_人脸1_片段1_10.1s-15.3s.mp4`
- `myvideo_google_seg_004_合并镜头1_0.0s-5.2s.mp4`

## 🎯 片段类型

### 镜头切分
- **格式**: `镜头{编号}` 或 `{智能标签}`
- **说明**: 基于视觉内容变化检测的镜头切分点
- **最小长度**: 0.5秒
- **连贯性**: 保证时间完全连贯，无空隙或重叠
- **智能标签**: 自动为每个镜头生成描述性标签（基于内容分析）

### 标签检测
- **格式**: `标签_{标签名}`
- **说明**: 基于物体、场景识别的内容片段
- **最小长度**: 1.0秒
- **支持**: 中文翻译（本地字典 + DeepSeek AI）
- **翻译覆盖**: 包含80+育儿、广告、视频制作相关词汇

### 人脸检测
- **格式**: `人脸{编号}_片段{编号}`
- **说明**: 包含人脸的视频片段
- **最小长度**: 1.0秒
- **跟踪**: 基于人脸检测轨迹进行片段划分

### 物体跟踪
- **格式**: `物体{编号}_片段{编号}`
- **说明**: 特定物体的跟踪片段
- **最小长度**: 1.0秒

## 🛠️ 技术细节

- **切分工具**: FFmpeg 高精度切分，集成 VideoProcessor 类
- **编码格式**: H.264 (libx264) + AAC
- **质量设置**: CRF 23 (高质量)
- **时间精度**: 毫秒级精确切分
- **完整性保证**: 避免黑屏和不完整片段
- **连贯性验证**: 自动检查镜头时间连贯性，无空隙或重叠

## 🔍 连贯性保证

Google Cloud Video Intelligence API 确保：
- ✅ 镜头完整覆盖整个视频（0秒到结束）
- ✅ 相邻镜头时间完全衔接（镜头A结束 = 镜头B开始）
- ✅ 无时间空隙或重叠
- ✅ 所有镜头时长之和 = 视频总时长

## 📊 功能特色

### 智能标签系统 🏷️
- **自动标签生成**: 基于Google Cloud分析结果为每个片段生成描述性标签
- **多语言支持**: 支持中文和英文标签生成
- **智能匹配**: 根据时间重叠匹配相关的物体、场景、人脸标签
- **标签统计**: 显示高频标签、总标签数、独特标签数等统计信息

### 智能翻译
- **本地字典**: 80+ 育儿、广告、视频制作词汇
- **AI增强**: DeepSeek API 智能翻译未知标签
- **双重保障**: 本地优先，AI补充的翻译策略

### 灵活切分
- **单类型切分**: 镜头、标签、人脸分别切分
- **综合切分**: 一次性处理所有类型
- **智能命名**: 文件名包含主要标签，便于识别
- **批量管理**: 统计信息、文件管理、快速定位

## 📊 使用统计

每次切分完成后，系统会显示：
- 各类型片段数量和分布
- 总文件大小和平均大小
- 总时长统计和平均时长
- 切分成功率和错误信息
- 镜头连贯性验证结果

## 🔧 故障排除

如果片段切分失败：
1. **视频文件检查**
   - 检查原始视频文件是否完整
   - 确认视频编码格式是否支持
   - 验证文件路径是否正确

2. **环境依赖**
   - 确认 FFmpeg 已正确安装
   - 检查 VideoProcessor 类是否正常工作
   - 验证 Python 环境和依赖包

3. **时间戳验证**
   - 确保开始时间 < 结束时间
   - 检查最小片段长度要求
   - 验证时间格式是否正确

4. **系统资源**
   - 检查磁盘空间是否充足
   - 确认输出目录权限
   - 监控内存使用情况

5. **API相关**
   - 验证 Google Cloud 凭据是否有效
   - 检查网络连接状态
   - 确认 API 配额和限制

## 📝 版本更新

### v4.0 更新内容
- ✅ 移除语音转录功能
- ✅ 新增镜头连贯性验证
- ✅ **新增智能标签系统**：自动为视频片段生成描述性标签
- ✅ **智能文件命名**：基于主要标签生成有意义的文件名
- ✅ **标签统计分析**：显示高频标签和使用统计
- ✅ 优化中文翻译覆盖范围
- ✅ 增强错误处理和调试信息
- ✅ 改进用户界面和交互体验

---
*由 AI视频分析大师 4.0 自动生成* 